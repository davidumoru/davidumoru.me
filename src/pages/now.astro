---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import CenteredLayout from "../layouts/CenteredLayout.astro";
import PageHeader from "../components/PageHeader.astro";
import { displayDate } from "../lib/mediumDate";

const posts = await getCollection("now");

posts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<BaseLayout
  title="Now"
  description="A snapshot of what I'm currently focused on â€” projects, routines, and ongoing interests."
>
  <CenteredLayout>
    <PageHeader title="Now" description="What I'm up to right now" />
    <div class="timeline">
      {
        posts.map((post) => (
          <div class="timeline-post">
            <div class="timeline-marker" />
            <div class="post-content">
              <p id="date">{displayDate(post.data.date)}</p>
              <div class="content">{post.body}</div>
            </div>
          </div>
        ))
      }
    </div>
  </CenteredLayout>

  <style>
    .timeline {
      position: relative;
    }

    .timeline::before {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 5px;
      width: 2px;
      background-color: var(--tomato-9);
    }

    .timeline-post {
      position: relative;
      margin-bottom: 2rem;
    }

    .timeline-post:last-child {
      margin-bottom: 0;
    }

    .timeline-marker::before {
      content: "";
      position: absolute;
      top:5px;
      width: 12px;
      height: 12px;
      background-color: var(--tomato-9);
    }

    .post-content {
      padding-left: var(--space-l);
    }

    .content {
      margin: var(--space-3xs) 0;
    }

    #date {
      color: var(--gray-12);
      font-weight: 500;
    }
  </style>
</BaseLayout>